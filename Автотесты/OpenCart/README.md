# Проектная работа "OpenCart"

## Цели:
- Ссылка на задание https://gitlab.itfbgroup.ru/aqa-homework/homework/-/blob/main/hw_9/README.md?ref_type=heads
- Автоматизация тест-кейсов
- Автоматизация тест-кейсов
- Возможность запуска на удаленной машине
- Построение отчетности через Allure
- Внедрение логирования для критически важного функционала
- В проекте необходимо использовать весь пройденный материал
- Для каждого элемента UI (за действенного в тесте) необходимо сделать проверку (столбец "Ожидаемый результат"), проверка должна быть в отдельном тесте.

#### Дополнительное задание(необязательное)
- Реализовать паттерн PageFactory 
- Использовать библиотеку behave python
- Использовать инструмент poetry


Предусловия для использования АПИ opencart3:

	Необходимо открыть админку:
		host/admin
		login: user
		password: bitnami
	Создать user-а для получения APi Key или использовать дефолтного:
		1. Открыть: System - Users - Api - Создать
		2. Заполнить поле API Username
		3. Сгенерировать API Key(Он используется первичного логина сессии)
		4. Выбрать Status "Enabled"
		5. Открыть вкладку IP Adresses и добавить свой ip с которого обращаетесь к опенкарт(есть подсказка Your current IP is)
		6. Сохранить

Получить токен
```
Запрос:
  POST {host}/index.php?route=api/login
Data заполнить пользователем из админки: 
  username
  key
ОР:
    Статус код 200
Response body:
    "success": "String",
    "api_token": "String"
```

## Таст-кейсы:

### Добавить товар в корзину:
```
  Запрос: 
    POST {host}/index.php?route=api/cart/add&api_token={user's_api_token}
  Data:
    product_id(можно поискать через дев тулс - элементс в ui)
    quantity
  ОР:
    Статус код 200
  Response body:
    {"success": "Success: You have modified your shopping cart!"}
    В базе данных в таблице oc_cart добавлен продукт для сессии с заданным количеством
 ```

### Изменить количество ранее добавленого товара в корзине:
```
Предварительные условия:
Добавить товар в корзину
Запрос:
  POST {host}/index.php?route=api/cart/edit&api_token={user's_api_token}
Data:
  key (cart_id из таблицы oc_cart)
  quantity
ОР:
  Статус код 200
Response body:
  {"success": "Success: You have modified your shopping cart!"}
  В базе данных в таблице oc_cart quantity = заданному
```

### Удалить ранее добавленый товар из корзины:
```
Предварительные условия:
  Добавить товар в корзину
Запрос:
  POST {host}/index.php?route=api/cart/remove&api_token={user's_api_token}
Data:
  key (cart_id из таблицы oc_cart)
ОР:
  Статус код 200
Response body:
  "success": "Success: You have modified your shopping cart!"
  В базе данных в таблице oc_cart удален продукт
```

### Получить содержимое корзины:

```
Предварительные условия:
  Добавить товар в корзину
Запрос:
  POST {host}/index.php?route=api/cart/products&api_token={user's_api_token}
Data:
  {}
ОР:
  Статус код 200
  Схема ответа Response body:
			{
			  "type": "object",
			  "properties": {
				"products": {
				  "type": "array",
				  "items": [
					{
					  "type": "object",
					  "properties": {
						"cart_id": {"type": ["string", "integer"]},
						"product_id": {"type": ["string", "integer"]},
						"name": {"type": "string"},
						"model": {"type": "string"},
						"option": {"type": ["array", "null"]},
						"quantity": {"type": "string"},
						"stock": {"type": "boolean"},
						"shipping": {"type": "string"},
						"price": {"type": "string"},
						"total": {"type": "string"},
						"reward": {"type": ["string", "integer", "null"]}
					  },
					  "required": [
						"cart_id",
						"product_id",
						"name",
						"model",
						"option",
						"quantity",
						"stock",
						"shipping",
						"price",
						"total",
						"reward"
					  ]
					}
				  ]
				},
				"vouchers": {"type": "array"},
				"totals": {
				  "type": "array",
				  "items": [
					{
					  "type": "object",
					  "properties": {
						"title": {"type": "string"},
						"text": {"type": "string"}
					  },
					  "required": [
						"title",
						"text"
					  ]
					}
				  ]
				}
			  },
			  "required": [
				"products",
				"vouchers",
				"totals"
			  ]
			}
```
### Изменения валюты для сессии

```
Запрос:
  POST {host}/index.php?route=api/currency&api_token={user's_api_token}
 Data:
currency(Доступны GBP, USD, EUR)
ОР:
  Статус код 200
Response body:
  "success": "Success: Your currency has been changed!"
  - Сделать запрос на получении корзины api/cart/products. В ответе, по ключу "totals" в массиве все значения валюты = заданной
  - В БД в таблице oc_session, для текущий сессии(session_id=api_token), в столбце data, в словаре ключ currency = заданной 
			
```
### Добавление ваучера в корзину для сессии:

```
Запрос:
  POST {host}/index.php?route=api/voucher/adds&api_token={user's_api_token}
  Data:
				{
					"from_name": "string"
					"from_email": "string"(e-mail формат)
					"to_name": "string"
					"to_email": "string"(e-mail формат)
					"amount": "string" (целое число обернутое в стринг)
					"code": "string'(Например 'V-1111')
					"message": "strng"
				}
ОР(проверить статус код, схему, БД):
  Статус код 200
Response body:
				"success": "Success: You have modified your shopping cart!"
			- В таблице oc_session в поле data проверить, что ваучер добавлен по ключу vouchers
			- После добавления ваучера сделать запрос получения корзины api/cart/products.
				В ответе значение ключа vouchers != null and соответсвует схеме
			"vouchers": {
			  "type": "array",
			  "items": [
				{
				  "type": "object",
				  "properties": {
					"code": {"type": "integer"},
					"description": {"type": "string"},
					"from_name": {"type": "string"},
					"from_email": {"type": "string"},
					"to_name": {"type": "string"},
					"to_email": {"type": "string"},
					"voucher_theme_id": {"type": "string"},
					"message": {"type": "string"},
					"price": {"type": "string"},
					"amount": {"type": "integer"}
				  },
				  "required": [
					"code",
					"description",
					"from_name",
					"from_email",
					"to_name",
					"to_email",
					"voucher_theme_id",
					"message",
					"price",
					"amount"
				  ]}]}
    
```
### Регистрация пользователя при оформление товара:

| Шаг | Действие                                                                               | Ожидаемый результат                                                                                                                                                       |
|-----|----------------------------------------------------------------------------------------| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | Открыть главную страницу opencart                                                      | Открыта главная страница opencart                                                                                                                                         |
| 2   | В панели с категорией товаров нажать "Cameras"                                         | Открыта страница товаров "Cameras"                                                                                                                                        |
| 3   | На карточке товара "Canon EOS 5D" нажать "Add to Cart"(иконка корзины)                 | Открылась карточка товара "Canon EOS 5D"                                                                                                                                  |
| 4   | В разделе "Available Options" в поле "Select" выбрать цвет "Red"                       | Поле заполнено значением "Red"                                                                                                                                            |
| 5   | В разделе "Available Options" в поле "Qty" ввести количество товара "2"                | Поле заполнено значением "2"                                                                                                                                              |
| 6   | Добавить товар в корзину. Нажать кнопку "Add to Cart"                                  | Появилось уведомление об успешном добавление товара.                                                                                                                          |
| 7   | В верхней навигационной панели нажать "Shopping Cart"                                  | Открылась корзина                                                                                                               |
| 8   | Нажать "Checkout"                                                                      | Открылась страница оформления                                                                                                                                         |
| 9   | Выбрать "Register Account"                                                             | Выбран "Register Account"                                                                                                                               |
| 10  | Нажать "Continue"                                                                      | "Step 2: Account & Billing Details " доступно к заполнению                                                                                                       |
| 11  | Заполнить поле "First Name" значением "Testname"                                       | Поле "First Name" заполнено значением "Testname" |
| 12  | Заполнить поле "Last Name" значением "Testlastname"                                    | Поле "Last Name" заполнено значением "Testlastname"                                                                                                                                               |
| 13  | Заполнить поле "E-Mail" значением "test@test.ru"                                       | Поле "E-Mail" заполнено значением "test@test.ru"                                                                                                                           |
| 14  | Заполнить поле "Address 1" значением "Pushkina-Kolotushkina 4"                         | Поле "Address 1" заполнено значением "Pushkina-Kolotushkina 4"                                                                                                                           |
| 15  | Заполнить поле "City" значением "Testcity"                                             | Поле "City" заполнено значением "Testcity"                                                                                        |
| 16  | Заполнить поле "Post Code" значением "123456"                                          | Поле "Post Code" заполнено значением "123456"                                                                                                     |
| 17  | Выбрать в поле "Country" значение "Antigua and Barbuda"                                | Поле "Country" заполнено значением "Antigua and Barbuda"                                                                                                    |
| 18  | Выбрать в поле "Region / State" значение "Barbuda"                                     | Поле "Region / State" заполнено значением "Barbuda"                                                                                                    |
| 19  | Заполнить поле "Password" значением "password"                                         | Поле "Password" заполнено значением "password"                                                                                                     |
| 20  | Заполнить поле "Password Confirm" значением "password"                                 | Поле "Password Confirm" заполнено значением "password"                                                                                                  |
| 21  | Активировать чекбокс на принятие политик "I have read and agree to the Privacy Policy" | Чек бокс активирован                                                                                                     |
| 22  | Нажать "Continue"                                                                      | "Step 4" доступен к заполнению                                                                                                  |
| 23  | Обновить страницу                                                                      | Страница обновлена                                                                                                     |
| 24  | В верхней навигационной панели нажать "My account"                                     | Открылся список для выбора действий                                                                                                     |
| 25  | В выпавшем списке нажать "My account"                                                  | Открыта страница аккаунта                                                                                                     |
| 26  | Нажать "Edit your account information"                                                 | Открылась страница "My Account Information". Данные совпадают с указанными при оформлении                                                                                                    |

### Оформление заказа авторизованным пользователем со страницы сравнения:
Предусловие: необходим созданный юзер с заполненым адресов в профиле

| Шаг | Действие                                                                                         | Ожидаемый результат                                                           |
|-----|--------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
| 1   | Открыть главную страницу opencart                                                                | Открыта главная страница opencart                                             |
| 2   | В верхней навигационной панели нажать "My account"                                               | Открылся список для выбора действий                                           |
| 3   | Выбрать "Login"                                                                                  | Открылась страница авторизации                                                |
| 4   | Заполнить поле "E-Mail" значением "test@test.ru"                                                 | Поле "E-Mail" заполнено значением "test@test.ru"                              |
| 5   | Заполнить поле "Password" значением "password"                                                   | Поле "Password" заполнено значением "password"                                |
| 6   | Нажать "Login"                                                                                   | Успешная авторизация. Открыта страница аккаунта.                              |
| 7   | В панели с категорией товаров нажать "Phones & PDAs"                                             | Открыта страница товаров "Phones & PDAs"                                      |
| 8   | На карточке товара "HTC Touch HD" нажать "Compare this Product"(добавить к сравнению)            | Появилось уведомление об успешном добавление товара к сравнению.              |
| 9   | На карточке товара "iPhone" нажать "Compare this Product"(добавить к сравнению)                  | Появилось уведомление об успешном добавление товара к сравнению.              |
| 10  | На карточке товара "Palm Treo Pro" нажать "Compare this Product"(добавить к сравнению)           | Появилось уведомление об успешном добавление товара к сравнению.              |
| 11  | В поисковой строке вверху страницы ввести в поисковую строку "Samsung"                           | Поисковая строка заполнена значением "Samsung"                                |
| 12  | Нажать кнопку поиск                                                                              | Открылась страница с результами поиска                                        |
| 13  | На карточке товара "Samsung Galaxy Tab 10.1" нажать "Compare this Product"(добавить к сравнению) | Появилось уведомление об успешном добавление товара к сравнению.              |
| 14  | Над карточками товаров нажать "Product Compare"                                                  | Открыта страница Product Comparison                                           |
| 15  | Нажать кнопку "Remove" под товаром "HTC Touch HD"                                                | Из сравнения удален "HTC Touch HD"                                            |
| 16  | Нажать кнопку "Add to Cart" под товаром "iPhone"                                                 | Появилось уведомление об успешном добавление товара в корзину.                |
| 17  | Нажать кнопку "Add to Cart" под товаром "Palm Treo Pro"                                          | Появилось уведомление об успешном добавление товара в корзину.                |
| 18  | В верхней навигационной панели нажать "Shopping Cart"                                            | Открылась страница "Shopping Cart"                                            |
| 19  | Нажать кнопку удаления товара "Palm Treo Pro"                                                    | Появилось уведомление о успешном удалении. Товар удален                       |
| 20  | В поле "Quantity" ввести значение "2" для товара "Iphone"                                        | Поле "Quantity" заполнено значением "2"                                       |
| 21  | Нажать кнопку "Update" для количества товара "Iphone"                                            | Появилось уведомление об успешном обновлении кол-ва. Цена "Total" увеличилась |
| 22  | Нажать на вкладку "Estimate Shipping & Taxes"                                                    | Появились поля для уточнения стоимости доставки                               |
| 23  | Выбрать в поле "Country" значение "Antigua and Barbuda"                                          | Поле "Country" заполнено значением "Antigua and Barbuda"                      |
| 24  | Выбрать в поле "Region / State" значение "Barbuda"                                               | Поле "Region / State" заполнено значением "Barbuda"                           |
| 25  | Заполнить поле "Post Code" значением "123456"                                                    | Поле "Post Code" заполнено значением "123456"                                 |
| 26  | Нажать кнопку "Get Quotes"                                                                       | Открылась форма "Shipping method options" для выбора способа доставки         |
| 27  | Нажать кнопку закрытия формы                                                                     | Форма закрыта. Открыта страница "Shopping Cart"                               |
| 28  | Нажать кнопку "Checkout"                                                                         | Открыта страница "Checkout"                                                   |
| 29  | Выбрать чек-бох "I want to use an existing address"(если не выбран)                              | Чек-бох "I want to use an existing address" активирован                       |
| 30  | Нажать "Continue"                                                                                | "Step 3" доступен к заполнению                                                |
| 31  | Выбрать чек-бох "I want to use an existing address"(если не выбран)                              | Чек-бох "I want to use an existing address" активирован                       |
| 32  | Нажать "Continue"                                                                                | "Step 4" доступен к заполнению                                                |
| 33  | В поле "Add Comments" добавить текст из 10 символов                                              | Поле заполнено                                                                |
| 34  | Нажать "Continue"                                                                                | "Step 5" доступен к заполнению                                                |
| 35  | Активировать чекбокс "I have read and agree to the Terms & Conditions"                           | Чекбокс активирован                                                           |
| 36  | Нажать "Continue"                                                                                | "Step 6" доступен к заполнению                                                |
| 37  | Нажать "Confirm Order"                                                                           | Открылась страница с сообщением, что заказ успешно оформлен.                  |
| 38  | В верхней навигационной панели нажать "My account"                                               | Открылся список для выбора действий                                           |
| 39  | Выбрать "Order History"                                                                          | Открыта история заказов. В ней присутствует созданный заказ                   |

### Заявка на возврат ранее заказанного товара
Предусловие: необходим авторизоваться под заранее созданным юзером с заполненым адресов в профиле

| Шаг | Действие                                                                | Ожидаемый результат                                                                                                          |
|-----|-------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------|
| 1   | Открыть главную страницу opencart                                       | Открыта главная страница opencart                                                                                            |
| 2   | В панели с категорией товаров навести мышкой на "Components"            | Выпал список выбора категории товаров                                                                                        |
| 3   | В выпавшем списке нажать "Monitors"                                     | Открыта страница с доступными к выбору мониторами                                                                            |
| 4   | Нажать кнопку "Add to Wish List" под товаром "Apple Cinema 30"          | Появилось уведомление об успешном добавление товара в виш лист. Рядом с кнопкой Wish List в верхней навигационной панели(1)  |
| 5   | Нажать кнопку "Add to Wish List" под товаром "Samsung SyncMaster 941BW" | Появилось уведомление об успешном добавление товара в виш лист. Рядом с кнопкой Wish List в верхней навигационной панели (2) |
| 6   | В верхней навигационной панели нажать "Wish List"                       | Открылась страница wishlist-а                                                                                                |
| 7   | Нажать кнопку "Add to Cart" товара "Apple Cinema 30"                    | Открылась страница добавления опций                                                                                          |
| 8   | Выбрать чекбокс "Medium" для опции "Radio"                              | чекбокс выбран                                                                                                               |
| 9   | Выбрать чекбокс "Checkbox 3" для опции "Checkbox"                       | чекбокс выбран                                                                                                               |
| 10  | Выбрать чекбокс "Checkbox 4" для опции "Checkbox"                       | чекбокс выбран                                                                                                               |
| 11  | Заполнить поле "Text" значением "Текст"                                 | Поле "Text" заполнено значением "Текст"                                                                                      |
| 12  | Нажать в поле "Select"                                                  | Открылся список выбора цвета                                                                                                 |
| 13  | В выпавшем списке выбрать "Yellow"                                      | В поле выбран цвет "Yellow"                                                                                                  |
| 14  | Заполнить поле "Textarea" значением "Текст"                             | Поле "Textarea" заполнено значением "Текст"                                                                                  |
| 15  | В поле "File" вставить пустой файл формата txt                          | Сообщение об успешном добавление файла                                                                                       |
| 16  | Поля дат и времени заполнить любым значением                            | Поля заполнены                                                                                                               |
| 17  | Заполнить поле "Qty" значением "2"                                      | Поле "Qty" заполнено значением "2"                                                                                           |
| 18  | Нажать кнопку "Add to Cart"                                             | Появилось уведомление об успешном добавлении товаров                                                                         |
| 19  | Нажать кнопку корзины справа от поля поиска                             | Выпало окно с описанием корзины                                                                                              |
| 20  | В форме нажать "Checkout"                                               | Открылась страница оформления заказа(адрес заполнен по умолчанию, адресом из профиля)                                        |
| 21  | Выбрать чек-бох "I want to use an existing address"(если не выбран)     | Чек-бох "I want to use an existing address" активирован                                                                      |
| 22  | Нажать "Continue"                                                       | "Step 3" доступен к заполнению                                                                                               |
| 23  | Выбрать чек-бох "I want to use an existing address"(если не выбран)     | Чек-бох "I want to use an existing address" активирован                                                                      |
| 24  | Нажать "Continue"                                                       | "Step 4" доступен к заполнению                                                                                               |
| 25  | В поле "Add Comments" добавить текст из 10 символов                     | Поле заполнено                                                                                                               |
| 26  | Нажать "Continue"                                                       | "Step 5" доступен к заполнению                                                                                               |
| 27  | Активировать чекбокс "I have read and agree to the Terms & Conditions"  | Чекбокс активирован                                                                                                          |
| 28  | Нажать "Continue"                                                       | "Step 6" доступен к заполнению                                                                                               |
| 29  | Нажать "Confirm Order"                                                  | Открылась страница с сообщением, что заказ успешно оформлен.                                                                 |
| 30  | В верхней навигационной панели нажать "My account"                      | Открылся список для выбора действий                                                                                          |
| 31  | В выпавшем списке нажать "Order History"                                | Открылась страница заказов                                                                                                   |
| 32  | Нажать "View" для ранее созданного заказа                               | Открылась страница заказа                                                                                                    |
| 33  | Нажать кнопку "Return" для ранее заказанного товара                     | Открылась страница оформления возврата                                                                                       |
| 34  | Заполнить поле "Telephone" любым 11-и значным номером                   | Поле "Telephone" заполнено введенным значением                                                                               |
| 35  | В поле "Reason for Return" нажать на любой чекбокс                      | Выбранный чекбокс активирован                                                                                                |
| 36  | Нажать "Submit"                                                         | Открыта страница сообщающая об успешном оформление возврата                                                                  |

#### Критерии оценки:

- Задание оформить отдельным merge-request'ом
- В репозитории отсутствуют лишние файлы
- Соблюдается минимальный кодстайл
